version: "2.0"
services:
  gitlab:
    build:
      context: ./src
    restart: always
    hostname: gitlab.peploleum.com
    ports:
    - "9022:22"
    - "9080:80"
    - "9443:443"
    volumes:
    - ./srv/data:/var/opt/gitlab
    - ./srv/logs:/var/log/gitlab
    - ./srv/config:/etc/gitlab
#    environment:
#      GITLAB_OMNIBUS_CONFIG: |
#        external_url 'http://localhost'
  gitlab-runner:
    image: gitlab/gitlab-runner:latest
    restart: always
    volumes:
    - ./srv/git-runner/config:/etc/gitlab-runner
    - ./srv/git-runner/home:/home/gitlab-runner
    - /var/run/docker.sock:/var/run/docker.sock

